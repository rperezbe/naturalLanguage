<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentiment Analysis</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>Natural Language Demo</h1>

    <!-- Tabs -->
    <div class="tabs">
        <div class="tab" onclick="openTab(event, 'entities')">Entities</div>
        <div class="tab" onclick="openTab(event, 'sentiment')">Sentiment</div>
        <div class="tab" onclick="openTab(event, 'moderation')">Moderation</div>
        <div class="tab" onclick="openTab(event, 'categories')">Categories</div>
    </div>

    <!-- Entity Tab Content -->
    <div id="entities" class="tabcontent"></div>

    <!-- Sentiment Tab Content -->
    <div id="sentiment" class="tabcontent"></div>

    <!-- Categories Tab Content -->
    <div id="categories" class="tabcontent"></div>

    <!-- Moderation Tab Content -->
    <div id="moderation" class="tabcontent"></div>

    <script>
        const jsonData = {
            "Sentiment": {
                "sentences": [
                    {
                        "text": {
                            "content": "La asignatura de Conversational AI, creada y dictada por Ismael Chaile, mola.",
                            "beginOffset": -1
                        },
                        "sentiment": {
                            "magnitude": 0.9750000238418579,
                            "score": 0.9279999732971191
                        }
                    },
                    {
                        "text": {
                            "content": "Los alumnos son muy majos y están entusiasmados en aprender.",
                            "beginOffset": -1
                        },
                        "sentiment": {
                            "magnitude": 0.9739999771118164,
                            "score": 0.902999997138977
                        }
                    },
                    {
                        "text": {
                            "content": "Parece que todos somos bastante frikis.",
                            "beginOffset": -1
                        },
                        "sentiment": {
                            "magnitude": 0.44999998807907104,
                            "score": 0.30399999022483826
                        }
                    }
                ],
                "documentSentiment": {
                    "magnitude": 2.3980000019073486,
                    "score": 0.7110000252723694
                },
                "languageCode": "es",
                "languageSupported": true
            },
            "Entities": {
                "entities": [
                    {
                        "mentions": [
                            {
                                "text": {
                                    "content": "Conversational AI",
                                    "beginOffset": -1
                                },
                                "type": "PROPER",
                                "sentiment": null,
                                "probability": 0.6990000009536743
                            }
                        ],
                        "metadata": {},
                        "name": "Conversational AI",
                        "type": "OTHER",
                        "sentiment": null
                    },
                    {
                        "mentions": [
                            {
                                "text": {
                                    "content": "Ismael Chaile",
                                    "beginOffset": -1
                                },
                                "type": "PROPER",
                                "sentiment": null,
                                "probability": 0.9010000228881836
                            }
                        ],
                        "metadata": {},
                        "name": "Ismael Chaile",
                        "type": "PERSON",
                        "sentiment": null
                    },
                    {
                        "mentions": [
                            {
                                "text": {
                                    "content": "alumnos",
                                    "beginOffset": -1
                                },
                                "type": "COMMON",
                                "sentiment": null,
                                "probability": 0.8949999809265137
                            }
                        ],
                        "metadata": {},
                        "name": "alumnos",
                        "type": "PERSON",
                        "sentiment": null
                    },
                    {
                        "mentions": [
                            {
                                "text": {
                                    "content": "asignatura",
                                    "beginOffset": -1
                                },
                                "type": "COMMON",
                                "sentiment": null,
                                "probability": 0.8420000076293945
                            }
                        ],
                        "metadata": {},
                        "name": "asignatura",
                        "type": "OTHER",
                        "sentiment": null
                    },
                    {
                        "mentions": [
                            {
                                "text": {
                                    "content": "todos",
                                    "beginOffset": -1
                                },
                                "type": "COMMON",
                                "sentiment": null,
                                "probability": 0.859000027179718
                            }
                        ],
                        "metadata": {},
                        "name": "todos",
                        "type": "PERSON",
                        "sentiment": null
                    }
                ],
                "languageCode": "es",
                "languageSupported": true
            },
            "Categories": {
                "categories": [
                    {
                        "name": "/Science/Computer Science/Machine Learning & Artificial Intelligence",
                        "confidence": 0.3232879340648651
                    },
                    {
                        "name": "/Reference/Language Resources/Foreign Language Resources",
                        "confidence": 0.21271079778671265
                    },
                    {
                        "name": "/Reference/General Reference/Educational Resources",
                        "confidence": 0.1668519675731659
                    }
                ],
                "languageCode": "es",
                "languageSupported": true
            },
            "Moderation": {
                "moderationCategories": [
                    {
                        "name": "Toxic",
                        "confidence": 0.056243885308504105
                    },
                    {
                        "name": "Insult",
                        "confidence": 0.05293005704879761
                    },
                    {
                        "name": "Profanity",
                        "confidence": 0.023985227569937706
                    },
                    {
                        "name": "Derogatory",
                        "confidence": 0.004792527295649052
                    },
                    {
                        "name": "Sexual",
                        "confidence": 0.0029740394093096256
                    },
                    {
                        "name": "Death, Harm & Tragedy",
                        "confidence": 0.05970149114727974
                    },
                    {
                        "name": "Violent",
                        "confidence": 0.05284553021192551
                    },
                    {
                        "name": "Firearms & Weapons",
                        "confidence": 0.0181818176060915
                    },
                    {
                        "name": "Public Safety",
                        "confidence": 0.02056807093322277
                    },
                    {
                        "name": "Health",
                        "confidence": 0.1031307578086853
                    },
                    {
                        "name": "Religion & Belief",
                        "confidence": 0.10110294073820114
                    },
                    {
                        "name": "Illicit Drugs",
                        "confidence": 0.03658536449074745
                    },
                    {
                        "name": "War & Conflict",
                        "confidence": 0.010416666977107525
                    },
                    {
                        "name": "Politics",
                        "confidence": 0.09366390854120255
                    },
                    {
                        "name": "Finance",
                        "confidence": 0.10169491171836853
                    },
                    {
                        "name": "Legal",
                        "confidence": 0.0317460335791111
                    }
                ],
                "languageCode": "es",
                "languageSupported": true
            }
        };

        function openTab(evt, tabName) {
            const tabcontents = document.querySelectorAll('.tabcontent');
            tabcontents.forEach(content => content.style.display = 'none');

            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            const selectedTab = document.getElementById(tabName);
            selectedTab.style.display = 'block';

            evt.currentTarget.classList.add('active');

            switch (tabName) {
                case 'entities':
                    showEntities(jsonData.Entities.entities);
                    break;
                case 'sentiment':
                    showSentiment(jsonData.Sentiment);
                    break;
                case 'categories':
                    showCategories(jsonData.Categories.categories);
                    break;
                case 'moderation':
                    showModeration(jsonData.Moderation.moderationCategories);
                    break;
                default:
                    break;
            }
        }
        // Función para mostrar el sentiment analysis
        function showSentiment(sentiment) {
            const sentimentDiv = document.getElementById('sentiment');
            sentimentDiv.innerHTML = `<h2>Document and Sentence Level Sentiment</h2>`;

            // Mostrar la fila de ENTIRE DOCUMENT
            const entireDocumentDiv = document.createElement('div');
            entireDocumentDiv.classList.add('sentiment-row');
            entireDocumentDiv.innerHTML = `<p class="sentence"><b>ENTIRE DOCUMENT</b></p><div class="score" style="background-color: ${getBackgroundColor(sentiment.documentSentiment.score)};">Score:<br> ${sentiment.documentSentiment.score.toFixed(2)}</div><div class="magnitude">Magnitude: <br> ${sentiment.documentSentiment.magnitude.toFixed(2)}</div>`;
            sentimentDiv.appendChild(entireDocumentDiv);

            // Mostrar el análisis de cada oración
            sentiment.sentences.forEach((sentence) => {
                const { text, sentiment } = sentence;
                const { magnitude, score } = sentiment;

                const sentenceDiv = document.createElement('div');
                sentenceDiv.classList.add('sentiment-row');
                sentenceDiv.innerHTML = `
            <p class="sentence">${text.content}</p>
            <div class="score" style="background-color: ${getBackgroundColor(score)};">Score:<br> ${score.toFixed(2)}</div>
            <div class="magnitude">Magnitude:<br> ${magnitude.toFixed(2)}</div>
        `;
                sentimentDiv.appendChild(sentenceDiv);
            });

            // Agregar una separacion de 20px entre el analsis y la leyenda
            const separationDiv = document.createElement('div');
            separationDiv.style.height = '20px'; 
            sentimentDiv.appendChild(separationDiv);

            // Agregar la leyenda al final
            const legendDiv = document.createElement('div');
            legendDiv.classList.add('sentiment-row');
            legendDiv.setAttribute('title', 'Score of the sentiment ranges from -1.0 (very negative) to 1.0 (very positive).');
            legendDiv.innerHTML = `
        <p class="sentence"><b>Score Range</b></p>
        <div class="score" style="background-color: #388e3c;">0.25 <span>—</span> 1.0</div>
        <div class="score" style="background-color: #f7cb4d;">-0.25 <span>—</span> 0.25</div>
        <div class="score" style="background-color: #e53935;">-1.0 <span>—</span> -0.25</div>
    `;

            sentimentDiv.appendChild(legendDiv);
        }

        // Función para obtener el color de fondo según el valor del score
        function getBackgroundColor(score) {
            if (score >= 0.25) {
                return "#388e3c"; // Verde
            } else if (score >= -0.25) {
                return '#f7cb4d'; // Amarillo
            } else {
                return '#e53935'; // Rojo
            }
        }
        const entities = jsonData.Entities.entities;

        // Función para obtener un color aleatorio
        function getRandomColor() {
            const letters = 'ABCDEF';
            let color = '#';

            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * letters.length)];
            }

            return color;
        }

        // Función para asignar colores a las entidades del documento
        function assignEntityColors(entities) {
            const entityColors = {};

            entities.forEach(entity => {
                const entityType = entity.type.toLowerCase();

                // Si no existe un color asignado para la entidad, asigna uno aleatorio
                // Si la entidad es de tipo 'other', no asigna un color sera gris
                if (!entityColors[entityType] && entityType !== 'other') {
                    entityColors[entityType] = getRandomColor();
                }
            });

            return entityColors;
        }

        // Función para mostrar el entity analysis
        function showEntities(entities) {
            const entityColors = assignEntityColors(entities);
            const entitiesDiv = document.getElementById('entities');
            entitiesDiv.innerHTML = '<h2>Entities Analysis</h2>';

            entities.forEach((entity, index) => {
                const word = entity.mentions.length > 0 ? entity.mentions[0].text.content : '';
                const entityType = entity.type.toLowerCase();

                const entityItem = document.createElement('div');
                entityItem.classList.add('entity-item', entityType);
                //asigna el color de fondo según el tipo de entidad
                entityItem.style.backgroundColor = entityColors[entityType];
                entityItem.innerHTML = `<p>${entity.type} - Word: ${word}</p>`;

                if (index % 2 === 0) {
                    // Si es un elemento par, crea una nueva fila
                    const entityRow = document.createElement('div');
                    entityRow.classList.add('entity-row');
                    entitiesDiv.appendChild(entityRow);
                }

                // Agrega el elemento de entidad a la última fila
                const entityRows = document.querySelectorAll('.entity-row');
                const lastEntityRow = entityRows[entityRows.length - 1];
                lastEntityRow.appendChild(entityItem);
            });
        }

        // Función para mostrar el moderation analysis
        function showModeration(moderationCategories) {
            const moderationDiv = document.getElementById('moderation');
            moderationDiv.innerHTML = '<h2>Moderation Analysis</h2>';

            moderationCategories.forEach((category, index) => {
                const moderationItem = document.createElement('div');
                moderationItem.classList.add('moderation-item');
                moderationItem.innerHTML = `<p><b>${category.name}</b> <br> <b>Confidence</b>: ${category.confidence * 100}%</p>`;

                if (index % 2 === 0) {
                    // Si es un elemento par, crea una nueva fila
                    const moderationRow = document.createElement('div');
                    moderationRow.classList.add('moderation-row');
                    moderationDiv.appendChild(moderationRow);
                }

                // Agrega el elemento de moderación a la última fila
                const moderationRows = document.querySelectorAll('.moderation-row');
                const lastModerationRow = moderationRows[moderationRows.length - 1];
                lastModerationRow.appendChild(moderationItem);
            });
        }

        // Función para mostrar el category analysis
        function showCategories(categories) {
            const categoriesDiv = document.getElementById('categories');
            categoriesDiv.innerHTML = '<h2>Category Analysis</h2>';

            categories.forEach((category, index) => {
                const categoryItem = document.createElement('div');
                categoryItem.classList.add('category-item');
                categoryItem.innerHTML = `<p><b>${category.name}</b> <br> <b>Confidence</b>: ${category.confidence * 100}%</p>`;

                if (index % 2 === 0) {
                    // Si es un elemento par, crea una nueva fila
                    const categoryRow = document.createElement('div');
                    categoryRow.classList.add('category-row');
                    categoriesDiv.appendChild(categoryRow);
                }

                // Agrega el elemento de categoría a la última fila
                const categoryRows = document.querySelectorAll('.category-row');
                const lastCategoryRow = categoryRows[categoryRows.length - 1];
                lastCategoryRow.appendChild(categoryItem);
            });
        }


        // Inicialmente, al cargar la página, muestra la pestaña 'entities'
        openTab(event, 'entities');
    </script>
</body>

</html>